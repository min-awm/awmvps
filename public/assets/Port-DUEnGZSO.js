import{u as D,r as b,b as a,A as i,o as p,c as m,a as t,w as T,f as h,v as $,bJ as k,h as x,i as y,k as C,F as L,j as O,t as g}from"./index-CDvfFfFm.js";import{P as R}from"./plus-g_L8IEEg.js";import{T as A}from"./trash-DZ0LvIuN.js";const N={class:"m-2 bg-white border rounded-md p-9"},U={class:"mb-6 overflow-hidden bg-white rounded-lg shadow-sm"},V={class:"p-4 border-b border-gray-200 sm:p-6"},F={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},I={type:"submit",class:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},S={class:"p-4 sm:p-6"},B={class:"overflow-x-auto"},M={class:"min-w-full border divide-y divide-gray-200"},j={class:"bg-white divide-y divide-gray-200"},q={class:"px-6 py-4 text-sm font-medium text-gray-900 whitespace-nowrap"},E={class:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap"},G={class:"flex px-6 py-4 text-sm font-medium text-right whitespace-nowrap"},J=["onClick"],X={class:"sr-only"},W={__name:"Port",setup(z){const r=D(),f=b([]),n=b({number:"",protocol:"TCP"});c();async function c(){try{const o=await a.get(`${i.LIST_PORT}`);if(o.success){const l=o.message.trim().split(`
`).map(d=>{const u=d.match(/(\w+)\s+dpt:(\d+)/);return u?{protocol:u[1],number:parseInt(u[2],10)}:null}).filter(d=>d!==null);f.value=l}else console.log(`Port: ${o.message}`)}catch(o){console.log(`Port: ${o}`)}}async function v(){try{const o=new FormData;o.append("port",n.value.number),o.append("protocol",n.value.protocol);const e=await a.post(`${i.OPEN_PORT}`,o);e.success?(n.value.number="",r.success("Thêm cổng thành công"),c()):(r.error("Lỗi thêm cổng dịch vụ"),console.log(`Port: ${e.message}`))}catch(o){console.log(`Port: ${o}`)}}async function w(o,e){try{const s=new FormData;s.append("port",o),s.append("protocol",e);const l=await a.post(`${i.DROP_PORT}`,s);l.success?(r.success("Xóa cổng thành công"),c()):(r.error("Lỗi xóa cổng dịch vụ"),console.log(`Port: ${l.message}`))}catch(s){console.log(`Port: ${s}`)}}async function P(){try{const o=await a.get(`${i.DROP_ALL_PORT}`);o.success?(r.success("Đã chặn mọi cổng"),c()):(r.error("Lỗi chặn mọi cổng"),console.log(`Port: ${o.message}`))}catch(o){console.log(`Port: ${o}`)}}async function _(){try{const o=await a.get(`${i.UNDO_DROP_ALL_PORT}`);o.success?(r.success("Đã cho phép mặc định"),c()):(r.error("Lỗi cho phép mặc định"),console.log(`Port: ${o.message}`))}catch(o){console.log(`Port: ${o}`)}}return(o,e)=>(p(),m("div",N,[e[9]||(e[9]=t("h1",{class:"mb-6 text-3xl font-bold text-gray-900"},"Cổng dịch vụ",-1)),t("div",U,[t("div",V,[e[6]||(e[6]=t("h2",{class:"mb-4 text-xl font-semibold text-gray-900"},"Thêm cổng mới",-1)),t("form",{onSubmit:T(v,["prevent"]),class:"space-y-4"},[t("div",F,[t("div",null,[e[2]||(e[2]=t("label",{for:"port",class:"block text-sm font-medium text-gray-700"}," Cổng ",-1)),h(t("input",{id:"port","onUpdate:modelValue":e[0]||(e[0]=s=>n.value.number=s),type:"text",required:"",class:"w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[$,n.value.number]])]),t("div",null,[e[4]||(e[4]=t("label",{for:"port-protocol",class:"block text-sm font-medium text-gray-700"}," Giao thức ",-1)),h(t("select",{id:"port-protocol","onUpdate:modelValue":e[1]||(e[1]=s=>n.value.protocol=s),required:"",class:"block w-full py-3 pl-3 pr-10 mt-1 text-base border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},e[3]||(e[3]=[t("option",{value:"TCP"},"TCP",-1),t("option",{value:"UDP"},"UDP",-1)]),512),[[k,n.value.protocol]])])]),t("div",null,[t("button",I,[x(y(R),{class:"w-5 h-5 mr-2"}),e[5]||(e[5]=C(" Thêm cổng "))])])],32)]),t("div",S,[e[8]||(e[8]=t("h2",{class:"mb-4 text-xl font-semibold text-gray-900"},"Danh sách cổng",-1)),t("div",B,[t("table",M,[e[7]||(e[7]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"}," Port "),t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"}," Protocol "),t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"}," Actions ")])],-1)),t("tbody",j,[(p(!0),m(L,null,O(f.value,(s,l)=>(p(),m("tr",{key:`Port-ports-${l}`},[t("td",q,g(s.number),1),t("td",E,g(s.protocol),1),t("td",G,[t("button",{onClick:d=>w(s.number,s.protocol),class:"text-red-600 hover:text-red-900"},[x(y(A),{class:"w-5 h-5"}),t("span",X,"Delete port "+g(s.number),1)],8,J)])]))),128))])])]),t("div",{class:"flex gap-4 mt-6"},[t("button",{onClick:P,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}," Chỉ cho phép các cổng đã cấu hình "),t("button",{onClick:_,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Cho phép mặc định ")])])])]))}};export{W as default};
